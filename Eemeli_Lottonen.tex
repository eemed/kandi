% !TEX encoding = UTF-8 Unicode
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 
% Tampereen yliopisto
% Luonnontieteiden tiedekunta
% Matematiikka
%
% Kandidaattitutkielman malli.
% Tutkielman matemaattinen sisältö on prof. Seppo Hyyrön.
%
% Päivitetty 23.9.2018
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Yli 60-sivuiset pro gradu -tutkielmat painetaan kaksipuolisina. Jos pro gradu -tutkielmassa on korkeintaan 60 sivua, se painetaan yksipuolisena eli vain paperin yhdelle puolelle. Näin sen vuoksi, että kovin ohuen tutkielman selkään ei mahdu tekijän nimeä. Sivumäärään lasketaan tutkielman kaikki sivut nimiösivusta viimeiseen liitesivuun asti.
\documentclass[a4paper,12pt,leqno,oneside]{report} % jos korkeintaan 60 sivua
%\documentclass[a4paper,12pt,leqno,twoside]{report} % jos yli 60 sivua
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[finnish]{babel}
\usepackage[intlimits]{amsmath}
%\usepackage{amssymb} % Ei tarvita, kun käytetään makropakettia newtxmath.
\usepackage{amsthm}
\usepackage{booktabs}

% Fontteina Times ja Helvetica.
\usepackage[scale=0.94]{tgheros} % Helvetica tekstifontit.
\usepackage{newtxtext} % Times tekstifontit.
\usepackage[vvarbb]{newtxmath} % Times matematiikkafontit.

% Vaihtoehtoisesti fontteina voi käyttää LaTeXin oletusarvoista Computer Modern -kirjainperhettä (poista tällöin edelliset komennot).
%\usepackage{lmodern}

\usepackage{bm} % Matematiikkatilan lihavat kursiivikirjaimet.
\usepackage{enumerate} % Luetelmanumeroiden muokkaamiseen.
%\usepackage{pdfpages} % Pdf-muotoisten liitteiden liittämiseen.

% Väliotsikoiden tyyliä muokataan makropaketilla titlesec. Jos tarvitset otsikkotasoa \subsubsection, niin muuta optio small muotoon medium.
\usepackage[rm,bf,small,pagestyles]{titlesec}
\titleformat{\chapter}{\normalfont\rmfamily\bfseries\LARGE}{\thechapter}{1em}{}
\titlespacing*{\chapter}{0pt}{-25pt}{30pt}

% Ulkoiset kuvatiedostot liitetään makropaketin graphicx komennolla \includegraphics.
\usepackage{graphicx}
%\graphicspath{{Kuvat/}} % Ulkoisten kuvatiedostojen kansio.

% Kelluvien kuvien ja taulukoiden oletusarvoista sijoittelua voi säätää makropaketin float komennolla \floatplacement.
\usepackage{float}
\floatplacement{figure}{htb}	% oletusarvo on tbp
\floatplacement{table}{htb}		% oletusarvo on tbp

% Kuvien ja taulukoiden otsikot muotoillaan makropaketilla caption.
\usepackage[%
margin=\leftmargini,
labelfont=bf,
labelsep=period,
tableposition=top,
]{caption}

% Hypertekstilinkkejä ja url-osoitteita voi tehdä makropaketilla hyperref, jota on kutsuttava viimeiseksi. Optioilla pdftitle ja pdfauthor pdf-tiedostoon lisätään tutkielman ja tekijän nimet metatietoina.
\usepackage[%
pdftitle={Algebrallista koodausteoriaa},
pdfauthor={Eemeli Lottonen},
hidelinks,
pdfpagemode=UseNone,
pdfstartview=FitH]{hyperref}
% Verkko-osoitteet tulostetaan samalla fontilla kuin muukin teksti:
\urlstyle{same}

% Kasvatetaan palstan korkeutta neljä riviä:
\addtolength{\textheight}{4\baselineskip}
\addtolength{\topmargin}{-3.5\baselineskip}

\setlength{\textwidth}{401pt} % Palstan leveys.
\setlength{\footskip}{4\baselineskip} % Sivunumeron etäisyys palstan alareunasta.

% Asetetaan marginaalit yhtäsuuriksi:
\setlength{\oddsidemargin}{0.5\paperwidth}
\addtolength{\oddsidemargin}{-0.5\textwidth}
\addtolength{\oddsidemargin}{-1in}
\setlength{\evensidemargin}{\oddsidemargin}

% Kandidaattitutkielmassa tarvitaan harvennettua riviväliä, jotta korjausmerkinnöille jää tilaa. Gradussa riviväliä ei harvenneta, joten seuraava rivi jätetään silloin pois.
\linespread{1.35}\selectfont % vain kandidaattitutkielmassa

% Lauseiden teksti kursivoidaan:
\theoremstyle{plain}
\newtheorem{lause}{Lause}[chapter]

% Määritelmien ja esimerkkien tekstiä ei yleensä kursivoida.
\theoremstyle{definition}
\newtheorem{maaritelma}{Määritelmä}[chapter]
\newtheorem{esimerkki}{Esimerkki}[chapter]

\DeclareMathOperator{\wt}{wt}

% Huomautuksia ei numeroida:
\theoremstyle{remark}
\newtheorem*{huomautus}{Huomautus}

% Kaavat numeroidaan luvuittain:
\numberwithin{equation}{chapter}

% Pitkä yhtälöketju voidaan jakaa eri sivuille:
\allowdisplaybreaks[1]

% Muutetaan lähdeluettelon otsikko, joka on oletusarvoisesti "Kirjallisuutta".
\AtBeginDocument{\renewcommand*{\bibname}{Lähteet}}

% Komento \Kuukausi tulostaa nykyisen kuukauden nimen isolla alkukirjaimella kirjoitettuna.
% \newcommand*{\Kuukausi}{\ifcase\ \month\ \or\ Tammi\or\ Helmi\or\ Maalis\or\ Huhti\or\ Touko\or\ Kesä\or\ Heinä\or\ Elo\or\ Syys\or\ Loka\or\ Marras\or\ Joulu\fi kuu}
\newcommand*{\Kuukausi}{\ifcase\month\or{}Tammi\or{}Helmi\or{}Maalis\or{}Huhti\or{}Touko\or{}Kesä\or{}Heinä\or{}Elo\or{}Syys\or{}Loka\or{}Marras\or{}Joulu\fi kuu}

    % Joitain komentoja matemaattisia merkintöjä varten:
    \newcommand*{\Nset}{\mathbb{N}}  % luonnollisten lukujen joukko
    \newcommand*{\Zset}{\mathbb{Z}}  % kokonaislukujen joukko
    \newcommand*{\Qset}{\mathbb{Q}}  % rationaalilukujen joukko
    \newcommand*{\Rset}{\mathbb{R}}  % reaalilukujen joukko
    \newcommand*{\Cset}{\mathbb{C}}  % kompleksilukujen joukko

    % Makropaketin amsmath käyttöohjeissa (amsldoc.pdf s. 18--19) suositellaan itseisarvolle ja normille seuraavia komentoja:
    \newcommand*{\abs}[1]{\left\lvert#1\right\rvert}   % itseisarvo
    \newcommand*{\norm}[1]{\left\lVert#1\right\rVert}  % normi

    % Matriiseille ja vektoreille kannattaa määritellä oma komentonsa. Komennon \bm asemesta voi tässä käyttää komentoa \mathbf, jos halutaan käyttää pystyjä eikä kursivoituja kirjaimia.
    \newcommand*{\mx}{\bm}  % matriisi tai vektori

    % Suomessa käytettävä integraaliinsijoitusmerkki saadaan alla olevalla komennolla \sijoitus{alaraja}{yläraja}. Tämän kanssa on hyvä käyttää amsmath-makropaketin optiota [intlimits], jolla integrointirajat asetetaan integraalimerkin ylä- ja alapuolelle eikä viereen kuten LaTeXissa oletusarvoisesti.
    \makeatletter
    \@ifpackageloaded{newtxmath}
    {\newcommand*{\sijoitus}[2]{\mathop{\bigg/}\limits_{\mspace{-11mu}#1}^{\mspace{10mu}#2}}}
    {\newcommand*{\sijoitus}[2]{\mathop{\Big/}\limits_{\mspace{-19mu}#1}^{\mspace{19mu}#2}}}
    \makeatother

    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    \begin{document}

    % Tutkielman nimiösivu:
    \begin{titlepage}
        \large\bfseries\centering

        \hrule height 1pt
        \medskip

        TAMPEREEN YLIOPISTO\\
        Kandidaattitutkielma
        % Pro gradu -tutkielma

        \medskip
        \hrule height 1pt

        \vspace{\fill}

        \raisebox{1.5cm}[0pt][0pt]{Eemeli Lottonen}\\[-\baselineskip]
        {\LARGE Algebrallista koodausteoriaa}

        \vspace{\fill}

        \hrule height 1pt
        \medskip

        Luonnontieteiden tiedekunta\\
        Matematiikka\\
        \Kuukausi\ \the\year{}

        \medskip
        \hrule height 1pt
    \end{titlepage}

    % Lasketaan nimiösivu mukaan sivunumerointiin:
    \setcounter{page}{2}

    \cleardoublepage{}

    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    % Sisällysluettelo.
    \tableofcontents

    %%% Poista välilyöntikomento \ 
    \cleardoublepage{}


    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %           https://matematiikkalehtisolmu.fi/sanakirja
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    \chapter{Johdanto}



    Koodausteoriassa käsitellään tiedonsiirron virhealttiutta ja erilaisia tapoja havaita ja korjata välityksessä tapahtuneita virheitä. Useat häiriötekijät voivat vaikuttaa viestiin, kun sitä yritetään välittää lähettimeltä vastaanottimelle. Jotta viesti vastaanotettaisiin tarkoitetussa merkityksessään on kehitetty erilaisia metodeja virheiden havaitsemiseen ja korjaamiseen. Tässä tutkielmassa käsittelemme \dots

    [ Mitä tutkielmassa tehdään ]


    [ Edellytykset ]

    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    \chapter{Lineaariset binäärikoodit}\label{ch: Lineaariset binäärikoodit}

    Useat kommunikointijärjestelmät käyttävät binäärijärjestelmää. Binäärijärjestelmässä mikä tahansa numero voidaan esittää muodossa, jossa on vain nollia ja ykkösiä. Esimerkiksi numero 9 on binäärijärjestelmässä bittijono 1001. Numeroita 
    $n \in \{ 0, 1 \} = \Zset_2$ kutsutaan biteiksi.

    Oletetaan viesti koostuu $k$ bitistä. Nyt viestiin voidaan lisätä korjausbittejä, joiden avulla voidaan havaita mahdolliset virheet. Muodostetaan siis koodisana, jonka pituus on $n$. Nyt koodisanan viestiosa koostuu $k$ bitistä ja korjausosa $n-k$ bitistä. Tätä pituuden ja korjausbittien suhdetta $R = \frac{k}{n}$ kutsutaan informaatiosuhteeksi~\cite[s.~267]{GW}.
    [KUVA]
    \begin{esimerkki}\label{esim:3bitsanat}
        Muodostetaan kaikki mahdolliset $k = 3$ bittiset sanat.
        \begin{center}
            \begin{tabular}[t]{llll}
                000 & 001 & 011 & 111 \\
                110 & 100 & 101 & 010 \\
            \end{tabular}
        \end{center}
        Määrittelemme sanoihin neljännen bitin 
        $x_4 = (x_1 + x_2 + x_3) \bmod2$. Kaikkien 4 bittisten sanojen joukko on siis seuraava:
        \[
            C = \{\, x_1x_2x_3x_4 \mid  x_i \in \{0,1\} = \Zset_2, 1 \le i \le 3, x_4 = (x_1 + x_2 + x_3) \bmod2\,\}
        \]
        Huomaamme, että kaikkien bittien summa $x_1 + x_2 + x_3 + x_4$ on aina parillinen, sillä jos kolmen ensimmäisen bitin summa $x_1 + x_2 + x_3$ on parillinen niin $x_4 = 0$ tai, jos summa on pariton niin $x_4 = 1$.
        Tämän tiedon avulla vastaanottimessa voidaan päätellä, onko välityksessä tapahtunut virhe. Jos sanan kaikkien bittien summa ei ole parillinen, on viesti varmasti väärä. Virhe siis huomataan, mutta ei tiedetä missä kohtaa se on tapahtunut.
    \end{esimerkki}
    \begin{esimerkki}\label{esim:3bitsanatjatko}
        Koodataan sana 101 samaan tapaan kuin 
        esimerkissä~\ref{esim:3bitsanat}. Lisätään neljäsbitti $x_4 = (x_1 + x_2 + x_3) \bmod2$, joten koodattu sana on 1010. Jatketaan koodausta vielä toistamalla koodattu sana uudelleen eli sanan 101 lopullinen koodattu muoto on 10101010. Oletetaan, että välityksessä tapahtuu yksi virhe. Nyt vastaanottimessa viesti paloittellaan 4 bitin koodisanoihin. Esimerkin~\ref{esim:3bitsanat} mukaan tiedetään kumpi koodisanoista on väärä ja täten osataan myös korjata virheen.
    \end{esimerkki}

    \section{Tarvittavien käsitteiden määritelmiä}
    \begin{maaritelma}[{\cite[s.~491]{PA}}]
        Olkoon $A$ jokin äärellinen joukko, kutsumme joukkoa $A$ \emph{aakkostoksi}.

        \begin{enumerate}
            \item Alkiota $u \in  A^n = \underbrace{A \times \cdots \times A}_{
                \text{$n$ kappaletta}}$ kutsutaan \emph{sanaksi}. Sanan $u$ pituus on $n$ ja se muodostuu aakkoston $A$ alkioista.
            \item Osajoukkoa $C \subseteq A^n$ kutsutaan \emph{koodiksi}.
            \item Alkiota $u \in C \subseteq A^n$ kutsutaan \emph{koodisanaksi}.
            \item Jos joukko $A$ on kunta, niin $A^n$ on $A$-vektoriavaruus. Jos nyt $C \subseteq A^n$ kutsutaan osajoukkoa $C$ \emph{lineaariseksi koodiksi}. Lisäksi jos $\dim_A C = k$ kutsutaan osajoukkoa $C$ $(n, k)$-\emph{koodiksi}. Jos $A = \Zset_2$ niin osajoukkoa $C$ kutsutaan \emph{lineaariseksi binäärikoodiksi}.
        \end{enumerate}
    \end{maaritelma}

    % TODO esimerkki aliavaruuden todisatamisesta

    % \begin{lause}\label{thm: kasautumispisteen ympäristössä}
    %     A on B
    % \end{lause}

    % \begin{proof}
    % Toimii
    % \end{proof}

    \section{Hamming etäisyys ja -paino}
    \begin{maaritelma}[{\cite[s.~492]{PA}}]\label{maar:perus}
        Olkoot $u$ ja $v$ sanoja vektoriavaruudesta $A^n$.
        \begin{enumerate}
            \item\label{kht:etaisyys} Sanojen $u$ ja $v$ komponenttien eroavaisuuksien lukumäärää kutsutaan Hamming etäisyydeksi ja sitä merkitään $d(u,v)$.
            \item\label{kht:paino} Hamming painolla tarkoitetaan sanan $u$, niiden komponenttien lukumäärää, jotka eroavat nollasta. Hamming painoa merkitään 
                $\wt(u)$.
            \item Olkoon $r\ge0$ reaaliluku. Nyt joukkoa
                \[
                    S_r(u) = \{\,v \in A^n \mid d(u, v) \le r \,\}
                \]
                kutsutaan sanan $u$ $r$-palloksi.
            \item Olkoon $C$ koodi vektoriavaruudessa $A^n$. Koodin $C$ minimietäisyys on
                \[
                    d = \min\{\, d(u, w) \mid u, w \in C, u \neq w \,\}.
                \]
        \end{enumerate}
    \end{maaritelma}

    \begin{lause}\label{lause:Hamming}
        Olkoot $u$, $v$ ja $w$ sanoja vektoriavaruudessa $A^n$, missä $A = \Zset_2$. Silloin seuraavat ehdot pätevät:
        \begin{enumerate}
            \item\label{kht:painoetaisyys} $\wt(u) = d(u, 0)$
            \item\label{kht:etaisyyspaino} $d(u, v) = \wt(u - v)$
            \item\label{kht:vaihdannaisuus}$d(u, v) = d(v, u)$
            \item\label{kht:nollaetaisyys} $d(u, v) = 0$, jos $u = v$
            \item\label{kht:kolmioey} $d(u, w) \le d(u, v) + d(v, w)$ \quad (kolmioepäyhtälö)
        \end{enumerate}
    \end{lause}

    \begin{proof}[Todistus \upshape(vrt. {\cite[s.~492]{PA}})]\label{tod: Hamming}
        Lauseen~\ref{lause:Hamming} kohta~\ref{kht:painoetaisyys} seuraa suoraan määritelmän~\ref{maar:perus} kohdista~\ref{kht:etaisyys} ja~\ref{kht:paino}.

        Kohdassa~\ref{kht:etaisyyspaino} sanan $u - v$ komponentti kohdassa $i$ on 1, jos sanat $u$ ja $v$ eroavat komponentissa~$i$. Nyt määritelmän perusteella saadaan $\wt(u - v) = d(u, v)$.

        Kohta~\ref{kht:vaihdannaisuus} seuraa suoraan määritelmän~\ref{maar:perus} kohdasta~\ref{kht:etaisyys}.

        Kohdassa~\ref{kht:nollaetaisyys} sanojen $u$ ja $v$ etäisyys $d(u, v) = 0$, jos sanojen $u$ ja $v$ kaikki komponentit kohdassa $i$ ovat samoja, kun $1 \le i \le n$.

        Kohdan~\ref{kht:kolmioey} todistus on hieman pidempi kuin muut. Olkoot $x = u - v$ ja $y = v - w$. Nyt lauseen~\ref{lause:Hamming} kohdan~\ref{kht:etaisyyspaino} nojalla epäyhtälön vasemmasta puolesta saadaan
        \[
            d(u,w) = \wt(u - w) = \wt(x + y).
        \]
        Samoin oikeasta puolesta saadaan
        \begin{gather*}
            d(u,v) = \wt(u - v) = \wt(x)\text{~ja} \\
            d(v,w) = \wt(v - w) = \wt(y).
        \end{gather*}
        Todistettava epäyhtälö on siis
        \[
            \wt(x + y) \le \wt(x) + \wt(y).
        \]
        Olkoot $x_i$ ja $y_i$ sanojen $x$ ja $y$ kohdassa $i$ olevia komponentteja. Olkoon myös sana $z = x + y$ ja sen kohdassa $i$ oleva komponentti $z_i$. Huomaamme, että  
        \[
            \wt(x + y) = \sum_{i = 1}^n z_i \qquad \wt(x) = \sum_{i =1}^n x_i \qquad \wt(y) = \sum_{i = 1}^n y_i.
        \]
        Riittää siis todistaa, että $z_i \le x_i + y_i$ kaikilla $1 \le i \le n$. Tämä seuraa kuitenkin suoraan siitä että $z_i = x_i + y_i \bmod 2$.
    \end{proof}

    \begin{esimerkki}
        Tarkastellaan sitten yhtä etäisyyden käyttömahdollisuutta välityksessä. Oletetaan, että viestin välityksessä tapahtuu yksi virhe. Silloin vastaanotetun koodisanan ja oikean koodisanan etäisyys on 1. Määritellään seuraavaksi koodi $C$, jonka minimietäisyys on $d = 3$.
        
        Esimerkissä~\ref{esim:3bitsanat} listasimme kaikki aakkoston $A^3$ sanat, missä $A = \Zset_2$. Koodataan nämä sanat lisäämällä kolme uutta komponenttia. Määritellään koodi $C \subseteq A^6$ seuraavasti:
        \begin{gather*}
            x_1x_2x_3x_4x_5x_6 \in C, \text{ jos} \\
            x_4 = x_1 + x_2 \\
            x_5 = x_1 + x_3 \\
            x_6 = x_2 + x_3.
        \end{gather*}
        % TODO Tähän se aliavaruus testi
        Listataan sitten uudelleen kaikki vektoriavaruuden $A^3$ sanat ja niiden koodisanat koodissa $C \subseteq A^6$.
        \begin{center}
            \begin{tabular}[t]{ll}
                sana & koodisana \\ \midrule
                000 & 000000\\
                001 & 001011\\
                011 & 011110\\
                111 & 111000\\
                110 & 110011\\
                100 & 100110\\
                101 & 101101\\
                010 & 010101\\
            \end{tabular}
        \end{center}
        Tarkastellaan seuraavaksi sanojen etäisyyttä toisistaan. Valitaan ensin sanat joiden etäisyys toisistaan on 1. Valitaan esimerkiksi sanat $110$ ja $100$. Kutsutaan niiden vastaavia koodisanoja $u = 110011 \in C$ ja $v = 100110 \in C$. Nyt alkuperäiset sanat eroavat vain yhdessä komponentissa, mutta niiden koodisanat eroavat kolmessa komponentissa eli $d(u,v) = 3$. Yleisesti jos kaksi sanaa eroavat vain komponentissa $i$, niin komponentti $i$ esiintyy kahdessa yhtälössä, jotka määrittelimme koodin $C$ tarkastuskomponenteille 
        $x_4$, $x_5$ ja $x_6$. Koodisanojen etäisyys on siis vähintään 3.

        Tarkastellaan sitten sanoja joiden etäisyys on 2. Valitaan sanat $110$ ja $101$. Olkoon niiden vastaavat koodisanat $u = 110011 \in C$ ja $v = 101101 \in C$, joiden etäisyys on $d(u, v) = 4$. Yleisesti jos sanat eroavat komponenteissa $i$ ja $j$, niin kahdessa yhtälöistä, jotka määrittelimme komponenteille $x_4x_5x_6$ esiintyy komponentti $i$, mutta ei komponenttia $j$ tai komponentti $j$, mutta ei komponenttia $i$. 
        
        Tarkastellaan sitten sanoja, joiden etäisyys toisistaan on 3. Jos jo sanojen etäisyys on 3, on koodisanojenkin etäisyys vähintään kolme, sillä sanat sisältyvät sellaisenaan koodisanaan. Täten olemme osoittaneet, että minimietäisyys tässä tapauksessa on $d = 3$.

        Oletetaan, että lähetettävä sana on 001 ja sen vastaava koodisana $u = 011110 \in C$. 
        Alussa oletettiin, että lähetyksessä tapahtuu yksi virhe. Kutsutaan tätä vastaan otettua koodisanaa koodisanaksi $v$. Koska kooodin $C$ minimietäisyys on $d = 3$, on lähetty koodisana $u$ ainoa, jonka etäisyys vastaanotetusta koodisanasta $v$ on $d(u,v) = 1$.
    \end{esimerkki}

    \begin{maaritelma}\label{maar:nkkoodi}
        Olkoot $C$ $(n, k)$-koodi ja $u = x_1x_2x_3\dots x_k \dots x_n \in C$ sen eräs koodisana. Nyt koodisanan $u$ ensimmäiset $k$ komponenttia muodostavat alkuperäisen viestin ja viimeisiä $n-k$ komponenttia kutsutaan parillisuus yhtälöiksi.
    \end{maaritelma}

    \chapter{Virheenkorjaaminen ja sivuluokkadekoodaus}

    \begin{lause}\label{lause:nncorrection}
        Olkoon koodi $C \subseteq A^n$ ja sen minimietäisyys $d$. Jos käytämme lähin-naapuri dekoodausta, niin kaikille $t \in \Nset$ pätee seuraavat ehdot:
        \begin{enumerate}
            \item\label{kht:vtunnistus} Koodi $C$ voi tunnistaa ainakin $t$ kappaletta virheitä, jos $t + 1 \le d$.
            \item\label{kht:vkorjaus} Koodi $C$ voi korjata ainakin $t$ kappaletta virheitä, jos $2t + 1 \le d$.
        \end{enumerate}
    \end{lause}

    \begin{proof}[Todistus \upshape(vrt. {\cite[s.~494]{PA}})]\label{tod:nncorrection}
        Aloitetaan lauseen~\ref{lause:nncorrection} kohdasta~\ref{kht:vtunnistus}. Olkoot koodi $C \in A^n$ ja sen minimietäisyys $d$. Valitaan sitten koodisana $u \in C$. Nyt pallo $S_t(u)$ sisältää kaikki mahdolliset vastaanotetut sanat, jos lähetetty koodisana oli $u$ ja välityksessä tapahtui enintään $t$ virhettä. Jos koodin $C$ minimietäisyys $d < t$, niin pallo $S_t(u)$ sisältää vain koodisanan $u$. Täten jos virheitä tapahtuu enintään $t$ kappaletta, niin vastaanotettu sana $w$ ei ole koodisana. Näin voimme tunnistaa, jos virheitä on tapahtunut enintään $t$ kappaletta.

        Kohdassa~\ref{kht:vkorjaus} aloitetaan samalla tavalla. Olkoot koodi $C \in A^n$ ja sen minimietäisyys $d$. Valitaan sitten kaksi koodisanaa $u, v \in C$ siten, että $u \neq v$. Jos minimietäisyydelle pätee $2t < d$, niin vastaanotettu sana $w$ ei voi sisältyä molempiin palloihin $S_t(u)$ ja $S_t(v)$. Tämä voidaan osoittaa olettamalla ensin, että sana $w$ kuuluu molempiin palloihin. Nyt kolmioepäyhtälöstä saadaan
        \[
            d(u,v) \le d(u,w) + d(w, v) \le t + t < d,
        \]
        joka on ristiriidassa minimietäisyyden määritelmän kanssa. Täten vastaanotettu sana $w$ voidaan aina korjata lähimpään koodisanaan.
    \end{proof}

    Rajoitutaan loppuosassa binäärikoodeihin eli $A = \Zset_2$.
    \begin{esimerkki}
        TODO
    \end{esimerkki}

    \begin{lause}\label{lause:Hammingrajoitus}
        Olkoon $C$ $(n, k)$-koodi, jonka minimietäisyys on $d \ge 2t +1$. Nyt siis koodi $C$ osaa korjata $t$ virhettä käyttämällä lähin-naapuri dekoodausta. Hamming-rajoitukseksi kutsutaan seuraavaa epäyhtälöä:
        \[
            2^k = \abs{C} \le \frac{2^n}{\binom{n}{0}+\binom{n}{1}+\binom{n}{2}+\cdots+\binom{n}{t}}
        \]
        missä
        \[
            \binom{n}{b} = \frac{n!}{b!(n-b)!}
        \]
        on binomikerroin ja $\abs{C}$ on koodin $C$ mahtavuus.
    \end{lause}

    \begin{proof}[Todistus \upshape(vrt. {\cite[s.495]{PA}})]\label{tod:Hammingrajoitus}
        Olkoon koodin $C \in \Zset_2$ dimensio $\dim_{\Zset_2}(C) = k$. Täten koodin $C$ mahtavuus $\abs{C} = 2^k$. Olkoon sitten koodisana $u \in C$. Nyt koodisana $w \in S_t(u)$, jos sanojen etäisyys $d(u,w) \le t$. Koodisanassa $u$ on $n$ komponenttia, joten binomikertoimesta $n! / b!(n-b)\!$ saadaan sanat, jotka eroavat sanasta $u$ $b$ komponentissa. Nyt pallon $S_t(u)$ mahtavuus on siis
        \[
            \abs{S_t(u)} = \binom{n}{0} + \binom{n}{1} +\binom{n}{2} +  \cdots + \binom{n}{t}.
        \]
        Koska $2t + 1 \le d$, niin ei ole olemassa alkioita $a \in S_t(u)$ ja $b \in S_t(v)$, jos $u \neq v$. Nyt siis alkioita kaikissa palloissa on yhteensä
        \[
            \sum_{u \in C}\abs{S_t(u)} = \abs{S_t(u)}\abs{C}.
        \]
        Kuitenkin vektoriavaruudessa $A^n$ alkioita on yhteensä $2^n$ kappaletta, koska $A = \Zset_2$.
        Tästä seuraa seuraava epäyhtälö:
        \begin{align*}
            \abs{S_t(u)}\abs{C} &\le 2^n \\
            \abs{C} &\le \frac{2^n}{\abs{S_t(u)}} \\
            \abs{C} &\le \frac{2^n}{\binom{n}{0} + \binom{n}{1} +\binom{n}{2} +  \cdots + \binom{n}{t}} 
        \end{align*}
    \end{proof}

    Olkoon $C$ $(n,k)$-koodi. Nyt vektoriavaruus $A^n$ on abelin ryhmä yhteenlaskun suhteen, sillä vektoriavaruuden aksioomiin sisältyy kaikki abelinryhmän aksioomat. Vektoriavaruuden $A^n$ mahtavuus on $2^n$. Nyt koodi $C$ on vektoriavaruuden $A^n$ aliryhmä yhteenlaskun suhteen ja sen mahtavuus on $2^k$. Koodilla $C$ on nyt $\frac{\abs{A^n}}{\abs{C}} = \frac{2^n}{2^k} = 2^{n-k}$ sivuluokkaa. 
    
    Seuraavaksi esittelemme sivuluokkakoodauksen koodin $C$ sivuluokkien avulla. Valitaan ensin jokaisesta sivuluokasta sana $u_i \in C$, siten että sanalla $u$ on pienin paino. Nyt jokainen sivuluokka on seuraavaa muotoa:
    \[
        u_1 + C, u_2 + C, \dots, u_N + C,
    \]
    missä $N = 2^{n-k}$. Valittuja sanoja $u_i$ kutsutaan \emph{sivuluokan johtajiksi}. Jos vastaanotetaan sana $w$, niin sanan $w$ täytyy kuulua johonkin sivuluokkaan.

    \begin{esimerkki}
        Olkoon joukko $\{\,1000,\, 0100,\, 0001\,\}$ kantana $(4,2)$-koodille $C$. Muodostetaan 
    \end{esimerkki}

    \begin{thebibliography}{9}
        % LaTeX ei oletusarvoisesti lisää lähdeluettelon otsikkoa sisällysluetteloon, joten se on tehtävä tässä erikseen:
        \addcontentsline{toc}{chapter}{\bibname}

        % \bibitem{Mathman}
        % Mathman, Z. \emph{An elementary course in mathematical analysis}.
        % New York: Birch and Star, 1990.

        \bibitem{PA}
        Papantonopoulou, A.
        \emph{Algebra Pure \& Applied}.
        Prentice-Hall, 2002.

        \bibitem{GW}
        Gilbert, W. J. \& Nicholson, W. K.
        \emph{Modern algebra with applications. Vol. 66}.
        John Wiley \& Sons, 2004.

\end{thebibliography}

\end{document}
